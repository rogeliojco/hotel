<% layout('layout/layout.ejs') %>

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-10 text-center">
      <div class="card shadow">
        <div class="card-body">
          <h2 class="card-title text-success mb-4">¡Reserva Confirmada!</h2>

          <% if (mensaje) { %>
            <p class="lead"><%= mensaje %></p>
          <% } %>

          <% if (reserva) { %>
            <hr>
            <h4 class="mt-4 mb-3">Detalles de su Reserva:</h4>
            <p><strong>Número de Transacción:</strong> <%= reserva.transaccionId %></p>
            <p><strong>Nombre:</strong> <%= reserva.nombre %></p>
            <p><strong>Email:</strong> <%= reserva.email %></p>
            <p>
              <strong>Fechas:</strong>
              <%= new Date(reserva.fechaInicio).toLocaleDateString('es-MX') %> a
              <%= new Date(reserva.fechaFin).toLocaleDateString('es-MX') %>
            </p>
            <p><strong>Precio Total:</strong> $<%= reserva.precioTotal %> MXN</p>

            <% if (reserva.habitaciones && reserva.habitaciones.length > 0) { %>
              <h5 class="mt-4 mb-3">Habitaciones reservadas:</h5>
              <div class="row">
                <% reserva.habitaciones.forEach(h => { %>
                  <div class="col-md-6 mb-3">
                    <div class="card h-100 shadow-sm">
                      <img src="<%= h.imagenUrl || '/images/hotel.jpg' %>" class="card-img-top" alt="Imagen habitación" style="height: 160px; object-fit: cover;">
                      <div class="card-body text-start">
                        <h5 class="card-title"><%= h.nombre || 'Habitación' %></h5>
                        <p class="mb-1"><strong>Tipo:</strong> <%= h.tipo || 'N/D' %></p>
                        <p class="mb-0"><strong>Precio por noche:</strong> $<%= h.precioNoche %> MXN</p>
                      </div>
                    </div>
                  </div>
                <% }); %>
              </div>
            <% } %>
          <% } %>

          <hr>
          <p class="mt-4">
            Recibirá un correo electrónico con los detalles de su reserva en breve.
          </p>
          <a href="/" class="btn btn-primary mt-3">Volver a la Página Principal</a>
        </div>
      </div>
    </div>
  </div>
</div>
